---
title: "Untitled"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r message=FALSE, warning=FALSE}
library(tidyverse)
library(readxl)
theme_set(theme_minimal())
options(scipen = 999)

hongkong_tourism <- read_excel("china-hongkong-tourism.xlsx") %>% mutate(pct_exp = exp_mainland / exp_total)
```

```{r}
g <- hongkong_tourism %>% 
  ggplot(aes(year, visitors_mainland)) +
  geom_line(size = 1.3, color = "blue") + 
  scale_x_continuous(limits = c(1995, 2017), 
                     breaks = seq(1995, 2017, 2)) +
  scale_y_continuous(limits = c(0, 50000), 
                     breaks = seq(0, 50000, 10000), 
                     labels = c("0", "10M", "20M", "30M", "40M", "50M")) + 
  labs(title = "Most Valuable Visitors", 
       subtitle = "Blue (left scale), Red (right scale)", 
       x = "", 
       y = "", 
       captions = "Source: Hong Kong Annual Digest of Statistics")

g + geom_line(data = hongkong_tourism_pct, aes(year, pct_exp * 60000), size = 1.3, color = "red") + 
  scale_y_continuous(limits = c(0, 50000), 
                     breaks = seq(0, 50000, 10000), 
                     labels = c("0", "10M", "20M", "30M", "40M", "50M"), 
                     sec.axis = sec_axis(~ . / 60000, name = "% of mainlanders' expenditure in total consumption")) + 
  labs(y = "# of visitors from mainland")

```

```{r}
hongkong_tourism_pct <- hongkong_tourism %>% 
  filter(year > 1999)

hongkong_tourism_pct %>% 
  ggplot(aes(year, pct_exp)) + 
  geom_point() +
  geom_line(size = 1.2) + 
  expand_limits(y = 0.2) + 
  scale_x_continuous(limits = c(2000, 2017), 
                     breaks = seq(2000, 2017, 2)) +
  scale_y_continuous(limits = c(0.2, 0.8), 
                     breaks = seq(0.2, 0.8, 0.1), 
                     labels = scales::percent_format()) + 
  labs(title = "Most Valuable Visitors", 
       subtitle = "% of mainland visitors (overnight) in total consumption", 
       x = "", 
       y = "",
       caption = "Source: Hong Kong Annual Digest of Statistics")
```

```{r}
hongkong_realestate <- read_excel("his_data_2.xls", col_names = FALSE, skip = 3)
```

